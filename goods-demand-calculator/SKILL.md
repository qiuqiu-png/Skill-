---
name: goods-demand-calculator
description: 根据库存、在途、销售数据自动计算门店补货需求量。当用户需要处理货盘数据、计算补单需求或提及库存需求分析时使用。
---

# 货盘需求计算器

自动计算门店补货需求量，基于库存、在途、销售数据进行智能分析。

## 功能说明

这个skill可以处理货盘Excel数据文件，根据以下规则自动计算每个门店的补货需求：

1. **筛选条件**：
   - B列（大类）= 足金 或 足金（新）
   - CI列（补单数量）> 0

2. **门店分组**：
   - 根据第6行的合并单元格自动识别门店分组
   - 在DS~YD列范围内查找所有门店

3. **需求计算规则**：
   - 对于每个门店的第7行"需求"列：
     - 如果 `库存 + 在途 - 销售 < 0`：需求 = `|库存 + 在途 - 销售| × 2`
     - 如果 `库存 + 在途 - 销售 ≥ 0`：需求 = `1`
   - 忽略销售 ≤ 0 或为空值的门店

4. **数据完整性**：
   - 保留原表所有公式
   - 保留原表所有格式
   - 保留原表所有合并单元格

## 使用方法

1. 准备好货盘数据Excel文件
2. 提供文件路径给Claude
3. 脚本会自动处理并生成新文件（文件名添加"_处理后"后缀）

## 示例

```
输入文件: /Users/nanyu/Desktop/货盘数据57.7.xlsx
输出文件: /Users/nanyu/Desktop/货盘数据57.7_处理后.xlsx
```

## 依赖项

- openpyxl

## 适用场景

- 珠宝门店货盘管理
- 库存需求分析
- 补单数量计算
- 多门店库存调配

## 注意事项

- 确保输入文件包含完整的门店数据结构
- 第6行必须包含门店名称的合并单元格
- 第7行必须包含"库存"、"在途"、"销售"、"需求"列标题
- 处理大型文件可能需要较长时间，请耐心等待
