# 款式销售排名分析 (Style Sales Ranking)

根据销售明细数据生成款式销售排名报表,支持多种分类维度和灵活的分类判定条件。

## 功能特性

- ✅ 自动排除"笼统款"数据
- ✅ 支持21种分类判定规则
- ✅ 生成跨店铺款式排名(多sheet格式)
- ✅ 生成单店款式排名报表
- ✅ 美化的Excel输出,带边框、颜色填充
- ✅ 目录页快速导航

## 使用方法

### 在Claude Code中使用

当用户需要分析销售数据时,直接提供销售明细文件路径即可:

```
用户: 分析这个销售明细表 /path/to/销售明细.xlsx
```

可选提供分类判定条件:

```
用户: 按这个分类判定条件分析 /path/to/分类判定条件.xlsx
```

### 作为Python模块使用

```python
from style_sales_ranking import StyleSalesRanking

# 创建分析对象
analyzer = StyleSalesRanking('/path/to/销售明细.xlsx')

# 加载数据
analyzer.load_data()

# 加载分类规则(可选)
analyzer.load_category_rules('/path/to/分类判定条件.xlsx')

# 应用分类
analyzer.apply_classification()

# 统计销售
analyzer.calculate_style_sales()

# 生成报表
analyzer.generate_cross_store_report('~/Desktop/门店款式销售排名.xlsx')
```

## 数据要求

### 销售明细数据字段
必须包含以下字段:
- `销售`: 标识记录类型
- `组织`: 门店名称
- `款式`: 款式名称
- `大类`: 产品大类
- `小类`: 产品小类
- `主题名称`: 主题
- `三级分类`: 三级分类
- `款式大类`: 款式大类
- `计量单位`: 克/件
- `销售件数`: 销售数量

### 分类判定条件格式
Excel文件包含以下列:
- 列B: 序号(1-N)
- 列C: 分类名称
- 列D: 判定条件描述

## 分类规则

支持以下21种分类(按优先级顺序):

1. **黄金戒指系列**: 三级分类含"戒指"的主题
2. **凤华&凤华2.0**: 主题名称含"凤华"
3. **恋恋风情**: 三级分类是"恋恋风情"
4. **点钻**: 主题名称含"繁花"
5. **新奢**: 款式名称开头是"S-"
6. **暮光之城**: 主题名称含"暮光之城"
7. **古韵传香**: 主题名称含"古韵传香"
8. **锦绣金**: 三级分类是"锦绣金"
9. **其他按克黄金(公司款)**: 足金/爱尚金,计量单位=克
10. **其他按克黄金(加盟专款)**: 足金/爱尚金,计量单位=克,主题含"QY"或"JM"
11. **DIY**: 款式大类是"DIY转运珠"
12. **按件黄金(公司款)**: 计量单位=件,主题不含"QY"或"JM"
13. **按件黄金(加盟专款)**: 计量单位=件,主题含"QY"或"JM"
14. **Less系列**: 主题名称含"Less"
15. **彩宝**: 主题名称含"彩宝"
16. **其他K金&铂金镶嵌**: 大类是18K/钻石/Pt950等
17. **爱情灵药**: 主题名称含"爱情灵药"
18. **娇玉系列**: 主题名称含"娇玉系列"
19. **抖音到店**: 主题名称含"抖音"
20. **盗墓笔记**: 主题名称含"盗墓"
21. **中药**: 主题名称含"中药"或"本草"

## 输出文件

### 跨店铺款式排名
- 文件名: `门店款式销售排名_YYYY-MM-DD.xlsx`
- 位置: 用户桌面
- 结构:
  - Sheet 1: 目录(包含所有分类链接)
  - Sheet 2-N: 各分类的款式排名

### 单店销售排名
- 文件名: `门店款式销售排名(单店销售)-{店名}_YYYY-MM-DD.xlsx`
- 位置: 用户桌面

## 注意事项

- 所有包含"笼统款"的款式会被自动排除
- 分类判定按优先级顺序执行
- 一个款式只会被分到第一个匹配的分类
- 确保源数据包含所有必要字段

## 更新日志

### 2025-12-11
- 初始版本
- 支持21种分类规则
- 自动排除笼统款
- 美化Excel输出
