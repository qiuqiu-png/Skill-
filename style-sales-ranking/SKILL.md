# 款式销售排名分析 Skill

根据销售明细数据生成款式销售排名报表,支持多种分类维度和灵活的分类判定条件。

## 何时使用

当用户需要分析销售数据并生成款式排名报表时使用,包括:
- 分析销售明细数据,按分类生成款式排名
- 支持跨店铺款式排名(多sheet格式)
- 支持单店款式排名分析
- 根据自定义分类判定条件进行分类

## 功能特性

### 1. 灵活的分类规则
- 支持基于多种字段的分类判定(三级分类、主题名称、款式名称、大类、计量单位等)
- **优先级顺序**: 款式名称 > 主题名称 > 三级分类 > 款式大类 > 大类
- 用户可通过Excel文件提供自定义分类判定条件

### 2. 数据过滤
- **永久规则**: 自动排除款式名称含"笼统款"的数据
- 只统计"销售"类型的记录

### 3. 报表格式

#### 格式1: 单店销售排名
- 针对单个门店的款式销售分析
- 包含分类、排名、大类、小类、款式、主题、销量等信息
- 支持添加库存和在途数据(如有)

#### 格式2: 跨店铺款式排名(多sheet)
- 包含目录页 + 多个分类sheet
- 每个分类独立sheet,展示该分类下所有款式的销售排名
- 美化格式,带边框、颜色填充、对齐等

### 4. 输出内容
- 分类内排名
- 销售件数统计
- 款式详细信息(大类、小类、主题等)
- 各分类销售统计汇总

## 使用示例

### 示例1: 基础分析
```
用户: 分析这个销售明细表格 /path/to/销售明细.xlsx
助手: [生成跨店铺款式排名报表,使用默认或历史分类规则]
```

### 示例2: 使用自定义分类
```
用户: 按这个分类判定条件分析 /path/to/分类判定条件.xlsx
助手: [读取分类判定条件,应用规则生成报表]
```

### 示例3: 单店分析
```
用户: 生成富阳门店的单店销售排名
助手: [筛选门店数据,生成单店排名报表]
```

## 分类判定条件格式

Excel文件应包含以下列:
- **序号**: 优先级顺序(1-N)
- **分类**: 分类名称
- **判定条件**: 文字描述的判定规则

### 支持的判定规则示例:
1. `三级分类含"戒指"的主题` → 黄金戒指系列
2. `主题名称含"凤华"2个字的` → 凤华&凤华2.0
3. `款式名称开头是"S-"` → 新奢
4. `款式大类是"DIY转运珠"` → DIY
5. `大类是"足金"、"足金(新)""爱尚金"的,计量单位是克` → 其他按克黄金
6. `计量单位是件,主题名称含"QY"或"JM"` → 按件黄金(加盟专款)

## 技术实现

### 数据处理流程
1. 读取销售明细Excel文件
2. 过滤数据(只保留"销售"记录,排除"笼统款")
3. 读取分类判定条件(如有提供)
4. 按优先级顺序应用分类规则
5. 统计每个款式的销售件数
6. 计算分类内排名
7. 生成Excel报表

### 分类逻辑
```python
def classify_item(row):
    # 优先级1: 款式名称
    # 优先级2: 主题名称
    # 优先级3: 三级分类
    # 优先级4: 款式大类
    # 优先级5: 大类 + 其他条件
    # 匹配第一个符合的分类后返回
```

### 报表生成
- 使用openpyxl库创建Excel
- 应用样式(字体、颜色、边框、对齐)
- 创建目录页和分类sheet
- 自动调整列宽

## 输出文件

### 跨店铺款式排名
文件名: `门店款式销售排名_YYYY-MM-DD.xlsx`
位置: 用户桌面

结构:
- Sheet 1: 目录(包含所有分类链接)
- Sheet 2-N: 各分类的款式排名

### 单店销售排名
文件名: `门店款式销售排名(单店销售)-{店名}_YYYY-MM-DD.xlsx`
位置: 用户桌面

## 注意事项

1. **笼统款过滤**: 所有包含"笼统款"的款式会被自动排除,不参与排名
2. **分类优先级**: 分类判定按字段优先级执行(款式名称 > 主题名称 > 三级分类 > 款式大类 > 大类),一个款式只会被分到第一个匹配的分类
3. **数据完整性**: 确保源数据包含必要字段(销售、组织、款式、大类、小类、主题名称、销售件数等)
4. **日期范围**: 报表会自动识别数据的日期范围并在标题中显示

## 常见问题

Q: 如何调整分类规则?
A: 提供新的分类判定条件Excel文件即可

Q: 是否支持库存和在途数据?
A: 支持,但需要在源数据中包含相关字段

Q: 可以分析多个门店吗?
A: 可以,跨店铺排名会汇总所有门店数据,也可以单独分析特定门店

Q: 分类数量有限制吗?
A: 无限制,支持任意数量的分类
